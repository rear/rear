<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>Relax-and-Recover: Disaster Recovery and System Migration solution (2015)</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>Relax-and-Recover: Disaster Recovery and System Migration solution (2015)</h1>
<span id="author">Dag Wieers</span><br />
<span id="email"><code>&lt;<a href="mailto:dag@wieers.com">dag@wieers.com</a>&gt;</code></span><br />
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p><em>This presentation is written in AsciiDoc and can be converted to
a LibreOffice/OpenOffice presentation using
<a href="http://github.com/dagwieers/asciidoc-odf">asciidoc-odf</a>.</em></p></div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_relax_and_recover">What is Relax-and-Recover ?</h2>
<div class="sectionbody">
<div class="paragraph"><p><em>Tool that implements a DR workflow for Linux</em></p></div>
<div class="paragraph"><p>Which basically means ?</p></div>
<div class="ulist"><ul>
<li>
<p>
Easy to deploy (set up and forget)
</p>
</li>
<li>
<p>
Makes recovery as easy as possible
</p>
</li>
<li>
<p>
Complete bare-metal disaster recovery
</p>
</li>
<li>
<p>
Integration for various Linux technologies
</p>
</li>
<li>
<p>
Integration with various back-up solutions
</p>
</li>
<li>
<p>
Modular framework written in Bash
</p>
</li>
<li>
<p>
Easy to extend to own needs
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_how_does_relax_and_recover_work">How does Relax-and-Recover work ?</h2>
<div class="sectionbody">
<div class="paragraph"><p>Relax-and-Recover builds a rescue image from the existing installation</p></div>
<div class="ulist"><ul>
<li>
<p>
Restored system is an accurate copy
</p>
</li>
<li>
<p>
Restored system supports the hardware
</p>
</li>
<li>
<p>
Exotic setups (kernel, hardware) guaranteed to work
</p>
</li>
<li>
<p>
What worked before keeps on working
</p>
</li>
<li>
<p>
Recovery is fully automated
</p>
</li>
</ul></div>
<div class="paragraph"><p>Backup software is integrated into rescue image</p></div>
<div class="ulist"><ul>
<li>
<p>
With a working configuration
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_a_backup_not_sufficient">Why is a backup not sufficient ?</h2>
<div class="sectionbody">
<div class="paragraph"><p>Backup only covers storing data safely/securely</p></div>
<div class="ulist"><ul>
<li>
<p>
Often only the data is available
</p>
</li>
<li>
<p>
DR is a manual and time-consuming process
</p>
</li>
</ul></div>
<div class="paragraph"><p>So manual disaster recovery risks:</p></div>
<div class="ulist"><ul>
<li>
<p>
unknown system storage and network configuration
</p>
</li>
<li>
<p>
incompatibilities between firmware/software/hardware
</p>
<div class="ulist"><ul>
<li>
<p>
using newer tools with older data (or vice versa)
</p>
</li>
<li>
<p>
hardware is not supported
</p>
</li>
</ul></div>
</li>
<li>
<p>
making manual mistakes (again and again)
</p>
</li>
<li>
<p>
working against the clock amidst chaos
</p>
</li>
<li>
<p>
frustration
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_what_does_relax_and_recover_bring_to_the_table">What does Relax-and-Recover bring to the table ?</h2>
<div class="sectionbody">
<div class="paragraph"><p>But the Relax-and-Recover rescue image takes care of the complete
recovery process until the system runs:</p></div>
<div class="ulist"><ul>
<li>
<p>
enabling the network and remote access
</p>
</li>
<li>
<p>
using tools to recreate an accurate/working copy
</p>
</li>
<li>
<p>
recreating hardware and software RAID
</p>
</li>
<li>
<p>
partitioning and creating file systems
</p>
</li>
<li>
<p>
starting the backup restore process
</p>
</li>
<li>
<p>
restoring the bootloader
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_relax_and_recover_functionality">Relax-and-Recover functionality</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Supported storage technologies
</p>
<div class="ulist"><ul>
<li>
<p>
HP SmartArray, SW RAID, DRBD, LVM, multipath
</p>
</li>
<li>
<p>
ext2/ext3/ext4, xfs, jfs, vfat, btrfs, LUKS
</p>
</li>
</ul></div>
</li>
<li>
<p>
Boot media or remote storage
</p>
<div class="ulist"><ul>
<li>
<p>
OBDR tape, ISO, USB, eSATA, network booting
</p>
</li>
<li>
<p>
NFS, CIFS, rsync, HTTP, FTP, SFTP, &#8230;
</p>
</li>
</ul></div>
</li>
<li>
<p>
Back-up backends
</p>
<div class="ulist"><ul>
<li>
<p>
IBM TSM, HP DataProtector, Symantec NetBackup,
    FDR/Upstream, Bacula, tar, rsync, Borg
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_how_is_relax_and_recover_used">How is Relax-and-Recover used ?</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Creating boot media: <code>rear mkrescue</code>
</p>
<div class="ulist"><ul>
<li>
<p>
Copies kernel, modules, minimal system
</p>
</li>
<li>
<p>
Saves storage layout, network configuration
</p>
</li>
<li>
<p>
Write boot media
</p>
</li>
</ul></div>
</li>
<li>
<p>
Restore system
</p>
<div class="ulist"><ul>
<li>
<p>
Boot Relax-and-Recover media
</p>
</li>
<li>
<p>
Optionally, modify storage/network config
</p>
</li>
<li>
<p>
Run: <code>rear recover</code>
</p>
</li>
<li>
<p>
Relax-and-Recover parses layout then creates diskrestore script
</p>
</li>
<li>
<p>
Relax-and-Recover initiates restore or prompts for restore
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_relax_and_recover_on_a_running_system">Relax-and-Recover on a running system</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><code>/-------------+       /-----------+       /-----------+
| Storage     |       | Collect   |       | Integrate |
| layout      | ----&gt; | new       | ----&gt; | required  |
| change      |       | storage   |       | backup    |
| detected    |       | layout    |       | strategy  |
+-------------/       +-----------/       +-----------/

                                                |
                                                V

/-------------+       /-----------+       /-----------+
| Off-site    |       | Push      |       | Create    |
| storage     | &lt;---- | recovery  | &lt;---- | new       |
| together    |       | image     |       | recovery  |
| with backup |       | centrally |       | image     |
+-------------/       +-----------/       +-----------/</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_nifty_features_to_help_relax">Nifty features to help relax</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Local GRUB integration (password protected)
</p>
</li>
<li>
<p>
Serial console support (think: disaster)
</p>
</li>
<li>
<p>
History-stuffing during recovery
</p>
</li>
<li>
<p>
Network and SSH key integration
</p>
</li>
<li>
<p>
Layout code guides you through recovery
</p>
<div class="ulist"><ul>
<li>
<p>
Menu&#8217;s and command-line in one session
</p>
</li>
<li>
<p>
Provides original storage info
</p>
</li>
</ul></div>
</li>
<li>
<p>
Beep, UID led and USB suspend integration
</p>
</li>
<li>
<p>
Syslinux management
</p>
</li>
<li>
<p>
Log-file on recovery media
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_use_case_belgian_federal_police_1">Use case: Belgian Federal Police /1</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Requirements:
</p>
<div class="ulist"><ul>
<li>
<p>
About 200 sites with each a set of Linux servers
</p>
</li>
<li>
<p>
Each server comes with a tape-drive
</p>
</li>
<li>
<p>
Single bootable tape to:
</p>
<div class="ulist"><ul>
<li>
<p>
Restore complete system
</p>
</li>
<li>
<p>
Restore from back-up
</p>
</li>
</ul></div>
</li>
<li>
<p>
Support for various technologies
</p>
<div class="ulist"><ul>
<li>
<p>
HP SmartArray, SW RAID, DRBD, LVM
</p>
</li>
<li>
<p>
OBDR, Bacula tape support
</p>
</li>
<li>
<p>
RHEL 4, RHEL5 and RHEL6 support
</p>
</li>
</ul></div>
</li>
<li>
<p>
End-user documentation in 3 languages
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_use_case_belgian_federal_police_2">Use case: Belgian Federal Police /2</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Solution:
</p>
<div class="ulist"><ul>
<li>
<p>
All requirements implement but&#8230;
</p>
</li>
<li>
<p>
New systems didn&#8217;t support bootable tape (OBDR)
</p>
</li>
<li>
<p>
USB is much more flexible than tape
</p>
<div class="ulist"><ul>
<li>
<p>
Can store multiple rescue images
</p>
</li>
<li>
<p>
Can store rescue images of multiple servers
</p>
</li>
<li>
<p>
Easier workflow (udev): insert, wait, pull (2 min max)
</p>
</li>
<li>
<p>
Cheaper
</p>
</li>
<li>
<p>
Implementation is more reliable
</p>
</li>
</ul></div>
</li>
<li>
<p>
Bonus implementation of flexible layout
</p>
</li>
<li>
<p>
Support migration scenarios
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_use_case_belgian_federal_police_3">Use case: Belgian Federal Police /3</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Relax-and-Recover config for USB rescue media:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">BACKUP</span><span style="color: #990000">=</span>BACULA
<span style="color: #009900">OUTPUT</span><span style="color: #990000">=</span>USB
<span style="color: #009900">USB_DEVICE</span><span style="color: #990000">=</span>/dev/disk/by-label/REAR-<span style="color: #993399">000</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
Relax-and-Recover config for USB backup media:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">BACKUP</span><span style="color: #990000">=</span>NETFS
<span style="color: #009900">OUTPUT</span><span style="color: #990000">=</span>USB
<span style="color: #009900">USB_DEVICE</span><span style="color: #990000">=</span>/dev/disk/by-label/REAR-<span style="color: #993399">000</span>
<span style="color: #009900">ONLY_INCLUDE_VG</span><span style="color: #990000">=(</span> vg00 <span style="color: #990000">)</span>
<span style="color: #009900">EXCLUDE_MOUNTPOINTS</span><span style="color: #990000">=(</span> /data <span style="color: #990000">)</span></tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_use_case_belgian_federal_police_4">Use case: Belgian Federal Police /4</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Relax-and-Recover config for OBDR rescue tapes:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">BACKUP</span><span style="color: #990000">=</span>BACULA
<span style="color: #009900">OUTPUT</span><span style="color: #990000">=</span>OBDR
<span style="color: #009900">BEXTRACT_DEVICE</span><span style="color: #990000">=</span>Ultrium-<span style="color: #993399">1</span>
<span style="color: #009900">BEXTRACT_VOLUME</span><span style="color: #990000">=</span>VOL-<span style="color: #990000">*</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
Relax-and-Recover config for OBDR backup tapes:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">BACKUP</span><span style="color: #990000">=</span>NETFS
<span style="color: #009900">OUTPUT</span><span style="color: #990000">=</span>OBDR
<span style="color: #009900">TAPE_DEVICE</span><span style="color: #990000">=</span>/dev/nst<span style="color: #993399">0</span></tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_use_case_centralized_images_1">Use case: Centralized images /1</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Requirements:
</p>
<div class="ulist"><ul>
<li>
<p>
Remote rescue images
</p>
</li>
<li>
<p>
Removable media for off-site storage
</p>
</li>
<li>
<p>
Easy restore of physical hosts and guests
</p>
</li>
</ul></div>
</li>
<li>
<p>
Solution:
</p>
<div class="ulist"><ul>
<li>
<p>
Cron creates image when Relax-and-Recover detects change
</p>
</li>
<li>
<p>
Images pushed through HTTP to PXE server/host
</p>
</li>
<li>
<p>
Stored on USB disks, rotated every week
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_use_case_centralized_images_2">Use case: Centralized images /2</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Label USB disk(s) and mount
</p>
</li>
<li>
<p>
Configure Apache to allow HTTP PUT to USB disk
</p>
</li>
<li>
<p>
Relax-and-Recover config in <em>/etc/rear/local.conf</em>:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">BACKUP</span><span style="color: #990000">=</span>BACULA
<span style="color: #009900">OUTPUT</span><span style="color: #990000">=</span>ISO
<span style="color: #009900">ISO_URL</span><span style="color: #990000">=</span>http<span style="color: #990000">:</span>//server<span style="color: #990000">:</span>port/path<span style="color: #990000">/</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
Relax-and-Recover cron-job at /etc/cron.d/rear:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content">
<pre><code>30 0 1 * * root /usr/sbin/rear mkrescue
30 1 * * * root /usr/sbin/rear checklayout || /usr/sbin/rear mkrescue</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_relax_and_recover_command_line_1">Relax-and-Recover command line /1</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><code>[root@moria rear]# rear help

Usage: $PROGRAM [-h|--help] [-V|--version] [-dsSv] [-D|--debugscripts SET] [-c DIR] [-r KERNEL] [--] COMMAND [ARGS...]
-snip-
List of commands:
 checklayout     check if the disk layout has changed
 dump            dump configuration and system information
 format          format and label media for use with rear
 mkbackup        create rescue media and backup system
 mkbackuponly    backup system without creating rescue media
 mkrescue        create rescue media only
 recover         recover the system; valid during rescue
 validate        submit validation information

Use 'rear -v help' for more advanced commands.</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_relax_and_recover_command_line_2">Relax-and-Recover command line /2</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><code>[root@moria rear]# rear help

Usage: $PROGRAM [-h|--help] [-V|--version] [-dsSv] [-D|--debugscripts SET] [-c DIR] [-r KERNEL] [--] COMMAND [ARGS...]

Available options:
 -h --help           usage information
 -c DIR              alternative config directory; instead of /etc/rear
 -d                  debug mode; log debug messages
 -D                  debugscript mode; log every function call (via 'set -x')
 --debugscripts SET  same as -d -v -D but debugscript mode with 'set -SET'
 -r KERNEL           kernel version to use; current: '$KERNEL_VERSION'
 -s                  simulation mode; show what scripts rear would include
 -S                  step-by-step mode; acknowledge each script individually
 -v                  verbose mode; show more output
 -V --version        version information

-snip-</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_hacking_on_relax_and_recover">Hacking on Relax-and-Recover</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
It is Bash !
</p>
</li>
</ul></div>
<div class="paragraph"><p>*Join the mailinglist</p></div>
<div class="ulist"><ul>
<li>
<p>
Understand modular framework and workflows
</p>
<div class="ulist"><ul>
<li>
<p>
Use: <code>rear -s &lt;workflow&gt;</code>
</p>
</li>
</ul></div>
</li>
<li>
<p>
Logging
</p>
<div class="ulist"><ul>
<li>
<p>
Logfile in: <em>/var/log/rear/rear-&lt;hostname&gt;.log</em>
</p>
</li>
</ul></div>
</li>
<li>
<p>
Debugging
</p>
<div class="ulist"><ul>
<li>
<p>
Verbose: <code>rear -v</code>
</p>
</li>
<li>
<p>
Debug: <code>rear -d</code>
</p>
</li>
<li>
<p>
Tracing: <code>rear -D</code>
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_project_future">Project future</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Functionality
</p>
<div class="ulist"><ul>
<li>
<p>
Improved rsync support (like rsnapshot or rbme)
</p>
</li>
<li>
<p>
More back-up backend integration
</p>
</li>
<li>
<p>
PXE integration
</p>
</li>
</ul></div>
</li>
<li>
<p>
Development
</p>
<div class="ulist"><ul>
<li>
<p>
Re-organize code base
</p>
</li>
<li>
<p>
Release management needs a process
</p>
</li>
<li>
<p>
Website and documentation not up-to-date
</p>
</li>
<li>
<p>
Change of development tools ?
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_development_team">Development team</h2>
<div class="sectionbody">
<div class="paragraph"><p>Consists of:</p></div>
<div class="ulist"><ul>
<li>
<p>
Schlomo Schapiro (original author)
</p>
</li>
<li>
<p>
Gratien D&#8217;haese (original author)
</p>
</li>
<li>
<p>
Jeroen Hoekx (new contributor)
</p>
</li>
<li>
<p>
Dag Wieers (new contributor)
</p>
</li>
</ul></div>
<div class="paragraph"><p>and various other contributors</p></div>
<div class="paragraph"><p>Development at Github</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://relax-and-recover.org/">http://relax-and-recover.org/</a>
</p>
</li>
<li>
<p>
<a href="mailto:rear-users@lists.relax-and-recover.org">rear-users@lists.relax-and-recover.org</a>
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_thank_you_for_listening">Thank you for listening</h2>
<div class="sectionbody">
<div class="paragraph"><p>Any questions, ideas, pull-requests ?</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_live_usb_demo">Live USB demo</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Demo USB/udev integration (check udev config !)
</p>
<div class="ulist"><ul>
<li>
<p>
Prepare USB stick: <code>rear format /dev/sdb</code>
</p>
</li>
<li>
<p>
Re-insert USB stick and wait until light goes out
</p>
</li>
</ul></div>
</li>
<li>
<p>
Demo restore procedure (disable udev rule !)
</p>
<div class="ulist"><ul>
<li>
<p>
Boot from KVM virtual machine
</p>
</li>
<li>
<p>
Re-insert USB stick and start virt-manager
</p>
</li>
<li>
<p>
Create VM with 4GB disk and boot VM
</p>
</li>
<li>
<p>
Show bash history and perform: <code>rear recover</code>
</p>
</li>
<li>
<p>
Show menu system and modify sizes
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2017-09-24 14:52:21 CEST
</div>
</div>
</body>
</html>
